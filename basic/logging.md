# 日志

## 内置方法

正如其它服务器软件一样，记录日志是特别重要的一件事情， Hapi 内建了一些有用的记录日志的方法，以及有限的查看这些日志的能力。

有两个几乎一样的方法 `server.log()` 以及 `request.log()`，它们的不同点在于他们触发什么事件，由什么对象触发这些事件，以及哪些数据会被自动关联，`server.log()` 触发的是与 `server` 相关的事件，服务器的 `URI` 会自动的被关联， `request.log()` 则触发服务器事件，同时会带有该请示的内部编号，这两个方法都接受三个参数：`tags`、`data`以及 `timestamp`。

`tags` 是用于标识事件一个字符串或者包含多个字符串的数组，想象它们就是日志的 `levels`，但是却比 `level` 更具表现力，比如，你可以像下面这样的标记一个从数据库中查询数据的错误：

```javascript
server.log(['error', 'database', 'read']);
```

任何由 `hapi` 创建的日志都会被关联 `hapi` 这个标签。

第二个参数 `data`，则是一个可选的字符串或者对象，这是真正用于描述日志事件的详情的错误消息或者任何其它信息，日志事件会自动的关联触发该事件的服务器的URI。

最后一个参数 `timestamp` 用于描述事件发生的时间，默认的，其值为 `Date.now()`，而且，仅在你真的有合理的理由修改该值是才去提供它，否则，你不需要提供该参数的值，系统会自动为你创建。

## 检索请示日志

`Hapi` 提供了一个种从 `request` 中检索请求日志的方法 `request.getLog()`，前提是你还有权限访问该 `request` 对象，如果没有提供任何参数，该方法会返回所有关联至该 `request` 对象的日志记录，若你提供一个或者多个标签作为参数，则该方法仅返回这些标签的日志。

## 配置

默认的，仅仅将未捕获的异常信息以及 Hapi API 的运行时错误打印至控制台，你可以通过修改默认配置，来修改这些行为，比如你如果想在打印台上打印出任何请求中被标记为 `error` 的日志，你可以像下面这样做：

```javascript
const server = new Hapi.Server({
	debug: {
		request: ['error']
	}
});
```

## 日志相关的插件

内置的方法总是只能解决很小一部分需求，若需要更多的对日志的控制，你还可以使用如 `good` 或者 `bucker` 这些插件。